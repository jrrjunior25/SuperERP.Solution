@page "/contas-receber"
@rendermode InteractiveServer

<PageTitle>Contas a Receber - SuperERP</PageTitle>

<MudText Typo="Typo.h4" Class="mb-4">Contas a Receber</MudText>

<MudCard>
    <MudCardContent>
        <MudButton Variant="Variant.Filled" Color="Color.Primary" StartIcon="@Icons.Material.Filled.Add">
            Nova Conta
        </MudButton>
        
        <MudTable Items="@contas" Class="mt-4" Hover="true" Breakpoint="Breakpoint.Sm">
            <HeaderContent>
                <MudTh>Vencimento</MudTh>
                <MudTh>Cliente</MudTh>
                <MudTh>Valor</MudTh>
                <MudTh>Status</MudTh>
                <MudTh>Ações</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Vencimento">@context.DataVencimento.ToString("dd/MM/yyyy")</MudTd>
                <MudTd DataLabel="Cliente">@context.Cliente</MudTd>
                <MudTd DataLabel="Valor">@context.Valor.ToString("C2")</MudTd>
                <MudTd DataLabel="Status">
                    <MudChip Size="Size.Small" Color="@GetStatusColor(context.Status)">@context.Status</MudChip>
                </MudTd>
                <MudTd>
                    <MudIconButton Icon="@Icons.Material.Filled.Payment" Size="Size.Small" Color="Color.Success" />
                </MudTd>
            </RowTemplate>
        </MudTable>
    </MudCardContent>
</MudCard>

@code {
    private List<ContaReceberDto> contas = new();

    protected override void OnInitialized()
    {
        contas = new List<ContaReceberDto>
        {
            new() { DataVencimento = DateTime.Now.AddDays(5), Cliente = "Cliente Exemplo", Valor = 1500.00m, Status = "Pendente" }
        };
    }

    private Color GetStatusColor(string status) => status switch
    {
        "Pago" => Color.Success,
        "Pendente" => Color.Warning,
        "Vencido" => Color.Error,
        _ => Color.Default
    };

    class ContaReceberDto
    {
        public DateTime DataVencimento { get; set; }
        public string Cliente { get; set; } = string.Empty;
        public decimal Valor { get; set; }
        public string Status { get; set; } = string.Empty;
    }
}
