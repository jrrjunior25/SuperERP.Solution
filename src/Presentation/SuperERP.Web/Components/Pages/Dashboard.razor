@page "/dashboard"
@rendermode InteractiveServer

<PageTitle>Dashboard - SuperERP</PageTitle>

<div class="d-flex justify-space-between align-center mb-6">
    <div>
        <MudText Typo="Typo.h4" Class="fw-bold">üìä Dashboard Executivo</MudText>
        <MudText Typo="Typo.body2" Color="Color.Default">Vis√£o geral do seu neg√≥cio em tempo real</MudText>
    </div>
    <MudButton Variant="Variant.Filled" Color="Color.Primary" StartIcon="@Icons.Material.Filled.Refresh" OnClick="CarregarDados">Atualizar</MudButton>
</div>

<MudGrid Spacing="3">
    <MudItem xs="12" sm="6" md="3">
        <MudCard Elevation="3" Class="pa-4 rounded-lg">
            <MudCardContent>
                <div class="d-flex justify-space-between align-center">
                    <div>
                        <MudText Typo="Typo.body2" Color="Color.Default">Faturamento Hoje</MudText>
                        <MudText Typo="Typo.h4" Color="Color.Primary" Class="mt-2 fw-bold">R$ 12.450</MudText>
                        <MudChip T="string" Size="Size.Small" Color="Color.Success" Icon="@Icons.Material.Filled.TrendingUp">+18%</MudChip>
                    </div>
                    <MudAvatar Color="Color.Primary" Size="Size.Large">
                        <MudIcon Icon="@Icons.Material.Filled.AttachMoney" Size="Size.Large" />
                    </MudAvatar>
                </div>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" sm="6" md="3">
        <MudCard Elevation="3" Class="pa-4 rounded-lg">
            <MudCardContent>
                <div class="d-flex justify-space-between align-center">
                    <div>
                        <MudText Typo="Typo.body2" Color="Color.Default">Vendas Hoje</MudText>
                        <MudText Typo="Typo.h4" Color="Color.Success" Class="mt-2 fw-bold">47</MudText>
                        <MudChip T="string" Size="Size.Small" Color="Color.Success" Icon="@Icons.Material.Filled.TrendingUp">+12%</MudChip>
                    </div>
                    <MudAvatar Color="Color.Success" Size="Size.Large">
                        <MudIcon Icon="@Icons.Material.Filled.ShoppingCart" Size="Size.Large" />
                    </MudAvatar>
                </div>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" sm="6" md="3">
        <MudCard Elevation="3" Class="pa-4 rounded-lg">
            <MudCardContent>
                <div class="d-flex justify-space-between align-center">
                    <div>
                        <MudText Typo="Typo.body2" Color="Color.Default">NFC-e Emitidas</MudText>
                        <MudText Typo="Typo.h4" Color="Color.Info" Class="mt-2 fw-bold">42</MudText>
                        <MudChip T="string" Size="Size.Small" Color="Color.Info">Hoje</MudChip>
                    </div>
                    <MudAvatar Color="Color.Info" Size="Size.Large">
                        <MudIcon Icon="@Icons.Material.Filled.Receipt" Size="Size.Large" />
                    </MudAvatar>
                </div>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" sm="6" md="3">
        <MudCard Elevation="3" Class="pa-4 rounded-lg">
            <MudCardContent>
                <div class="d-flex justify-space-between align-center">
                    <div>
                        <MudText Typo="Typo.body2" Color="Color.Default">Ticket M√©dio</MudText>
                        <MudText Typo="Typo.h4" Color="Color.Warning" Class="mt-2 fw-bold">R$ 265</MudText>
                        <MudChip T="string" Size="Size.Small" Color="Color.Success" Icon="@Icons.Material.Filled.TrendingUp">+8%</MudChip>
                    </div>
                    <MudAvatar Color="Color.Warning" Size="Size.Large">
                        <MudIcon Icon="@Icons.Material.Filled.LocalOffer" Size="Size.Large" />
                    </MudAvatar>
                </div>
            </MudCardContent>
        </MudCard>
    </MudItem>
</MudGrid>

<MudGrid Spacing="3" Class="mt-4">
    <MudItem xs="12" md="8">
        <MudCard Elevation="3" Class="rounded-lg">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6" Class="fw-bold">üìà Faturamento dos √öltimos 7 Dias</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudChart ChartType="ChartType.Line" ChartSeries="@Series" XAxisLabels="@XAxisLabels" Width="100%" Height="350px" />
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" md="4">
        <MudCard Elevation="3" Class="rounded-lg" Style="height: 100%;">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6" Class="fw-bold">üéØ Metas do M√™s</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <div class="mb-4">
                    <div class="d-flex justify-space-between mb-2">
                        <MudText Typo="Typo.body2">Faturamento</MudText>
                        <MudText Typo="Typo.body2" Class="fw-bold">75%</MudText>
                    </div>
                    <MudProgressLinear Color="Color.Primary" Value="75" Size="Size.Large" />
                    <MudText Typo="Typo.caption" Class="mt-1">R$ 75.000 / R$ 100.000</MudText>
                </div>

                <div class="mb-4">
                    <div class="d-flex justify-space-between mb-2">
                        <MudText Typo="Typo.body2">Vendas</MudText>
                        <MudText Typo="Typo.body2" Class="fw-bold">82%</MudText>
                    </div>
                    <MudProgressLinear Color="Color.Success" Value="82" Size="Size.Large" />
                    <MudText Typo="Typo.caption" Class="mt-1">410 / 500 vendas</MudText>
                </div>

                <div>
                    <div class="d-flex justify-space-between mb-2">
                        <MudText Typo="Typo.body2">Novos Clientes</MudText>
                        <MudText Typo="Typo.body2" Class="fw-bold">60%</MudText>
                    </div>
                    <MudProgressLinear Color="Color.Info" Value="60" Size="Size.Large" />
                    <MudText Typo="Typo.caption" Class="mt-1">30 / 50 clientes</MudText>
                </div>
            </MudCardContent>
        </MudCard>
    </MudItem>
</MudGrid>

<MudGrid Spacing="3" Class="mt-4">
    <MudItem xs="12" md="6">
        <MudCard Elevation="3" Class="rounded-lg">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6" Class="fw-bold">üèÜ Top 5 Produtos</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudList T="string">
                    @foreach (var produto in topProdutos)
                    {
                        <MudListItem T="string">
                            <div class="d-flex justify-space-between align-center w-100">
                                <div class="d-flex align-center">
                                    <MudAvatar Color="Color.Primary" Size="Size.Small" Class="mr-3">@produto.Posicao</MudAvatar>
                                    <div>
                                        <MudText Typo="Typo.body1">@produto.Nome</MudText>
                                        <MudText Typo="Typo.caption">@produto.Vendas vendas</MudText>
                                    </div>
                                </div>
                                <MudText Typo="Typo.body1" Class="fw-bold">@produto.Valor.ToString("C2")</MudText>
                            </div>
                        </MudListItem>
                        <MudDivider />
                    }
                </MudList>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" md="6">
        <MudCard Elevation="3" Class="rounded-lg">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6" Class="fw-bold">‚ö° Atividades Recentes</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudTimeline TimelineOrientation="TimelineOrientation.Vertical">
                    <MudTimelineItem Color="Color.Success" Size="Size.Small">
                        <MudText Typo="Typo.body2">Venda #1247 finalizada</MudText>
                        <MudText Typo="Typo.caption">H√° 5 minutos</MudText>
                    </MudTimelineItem>
                    <MudTimelineItem Color="Color.Info" Size="Size.Small">
                        <MudText Typo="Typo.body2">NFC-e autorizada</MudText>
                        <MudText Typo="Typo.caption">H√° 12 minutos</MudText>
                    </MudTimelineItem>
                    <MudTimelineItem Color="Color.Primary" Size="Size.Small">
                        <MudText Typo="Typo.body2">Novo cliente cadastrado</MudText>
                        <MudText Typo="Typo.caption">H√° 25 minutos</MudText>
                    </MudTimelineItem>
                    <MudTimelineItem Color="Color.Warning" Size="Size.Small">
                        <MudText Typo="Typo.body2">Pagamento PIX recebido</MudText>
                        <MudText Typo="Typo.caption">H√° 1 hora</MudText>
                    </MudTimelineItem>
                </MudTimeline>
            </MudCardContent>
        </MudCard>
    </MudItem>
</MudGrid>

@code {
    private List<ChartSeries> Series = new();
    private string[] XAxisLabels = { "Seg", "Ter", "Qua", "Qui", "Sex", "S√°b", "Dom" };
    private List<TopProduto> topProdutos = new();

    protected override void OnInitialized()
    {
        Series = new List<ChartSeries>
        {
            new ChartSeries { Name = "Faturamento", Data = new double[] { 8500, 9200, 10100, 8800, 12450, 15200, 11800 } }
        };

        topProdutos = new List<TopProduto>
        {
            new() { Posicao = 1, Nome = "Notebook Dell", Vendas = 15, Valor = 4500 },
            new() { Posicao = 2, Nome = "Mouse Logitech", Vendas = 42, Valor = 1260 },
            new() { Posicao = 3, Nome = "Teclado Mec√¢nico", Vendas = 28, Valor = 2240 },
            new() { Posicao = 4, Nome = "Monitor LG 24\"", Vendas = 12, Valor = 1800 },
            new() { Posicao = 5, Nome = "Webcam HD", Vendas = 35, Valor = 1750 }
        };
    }

    private void CarregarDados()
    {
        // Implementar
    }

    class TopProduto
    {
        public int Posicao { get; set; }
        public string Nome { get; set; } = string.Empty;
        public int Vendas { get; set; }
        public decimal Valor { get; set; }
    }
}
